# Global Helm values for TikTok Clone
# This values file is used as the base configuration

global:
  environment: production
  domain: tiktok-clone.local
  imagePullPolicy: IfNotPresent

# Namespace
namespace: tiktok-clone

# PostgreSQL Configuration
postgresql:
  enabled: true
  image:
    repository: postgres
    tag: '15-alpine'
  auth:
    username: postgres
    password: 'postgres' # Change in production!
    database: tiktok_clone
  persistence:
    size: 10Gi
    path: /mnt/data/postgres
  resources:
    requests:
      memory: '256Mi'
      cpu: '250m'
    limits:
      memory: '512Mi'
      cpu: '500m'

# Redis Configuration
redis:
  enabled: true
  image:
    repository: redis
    tag: '7-alpine'
  persistence:
    size: 5Gi
    path: /mnt/data/redis
  resources:
    requests:
      memory: '128Mi'
      cpu: '100m'
    limits:
      memory: '256Mi'
      cpu: '200m'

# Kafka Configuration
kafka:
  enabled: true
  image:
    repository: confluentinc/cp-kafka
    tag: '7.6.0'
  persistence:
    size: 10Gi
    path: /mnt/data/kafka
  brokers: 1
  resources:
    requests:
      memory: '512Mi'
      cpu: '250m'
    limits:
      memory: '1Gi'
      cpu: '500m'

# Services Configuration
services:
  # Auth Service
  auth:
    name: auth-service
    replicas: 2
    image:
      repository: tiktok-auth-service
      tag: latest
    port: 4001
    grpcPort: 50051
    resources:
      requests:
        memory: '256Mi'
        cpu: '200m'
      limits:
        memory: '512Mi'
        cpu: '500m'
    autoscaling:
      enabled: true
      minReplicas: 2
      maxReplicas: 5
      targetCPUUtilizationPercentage: 70

  # Video Service
  video:
    name: video-service
    replicas: 2
    image:
      repository: tiktok-video-service
      tag: latest
    port: 4002
    grpcPort: 50052
    resources:
      requests:
        memory: '256Mi'
        cpu: '200m'
      limits:
        memory: '512Mi'
        cpu: '500m'
    autoscaling:
      enabled: true
      minReplicas: 2
      maxReplicas: 5
      targetCPUUtilizationPercentage: 70

  # Interaction Service
  interaction:
    name: interaction-service
    replicas: 2
    image:
      repository: tiktok-interaction-service
      tag: latest
    port: 4003
    grpcPort: 50053
    resources:
      requests:
        memory: '256Mi'
        cpu: '200m'
      limits:
        memory: '512Mi'
        cpu: '500m'
    autoscaling:
      enabled: true
      minReplicas: 2
      maxReplicas: 5
      targetCPUUtilizationPercentage: 70

  # Notification Service
  notification:
    name: notification-service
    replicas: 2
    image:
      repository: tiktok-notification-service
      tag: latest
    port: 4004
    grpcPort: 50054
    resources:
      requests:
        memory: '256Mi'
        cpu: '200m'
      limits:
        memory: '512Mi'
        cpu: '500m'
    autoscaling:
      enabled: true
      minReplicas: 2
      maxReplicas: 5
      targetCPUUtilizationPercentage: 70

  # API Gateway
  gateway:
    name: api-gateway
    replicas: 2
    image:
      repository: tiktok-api-gateway
      tag: latest
    port: 4000
    serviceType: LoadBalancer
    resources:
      requests:
        memory: '256Mi'
        cpu: '200m'
      limits:
        memory: '512Mi'
        cpu: '500m'
    autoscaling:
      enabled: true
      minReplicas: 2
      maxReplicas: 5
      targetCPUUtilizationPercentage: 75

# Secrets
secrets:
  # Database
  database:
    username: postgres
    password: 'postgres'

  # JWT
  jwt:
    accessSecret: 'your-secret-key-please-change-in-production'
    refreshSecret: 'your-refresh-key-please-change-in-production'

  # Grafana
  grafana:
    adminPassword: 'admin123'

# Monitoring Configuration
monitoring:
  enabled: true
  prometheus:
    enabled: true
    image: prom/prometheus:latest
    port: 9090
  grafana:
    enabled: true
    image: grafana/grafana:latest
    port: 3000
  elasticsearch:
    enabled: true
    image: docker.elastic.co/elasticsearch/elasticsearch:8.11.0
    port: 9200
